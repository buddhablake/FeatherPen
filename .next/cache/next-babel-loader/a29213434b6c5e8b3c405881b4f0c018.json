{"ast":null,"code":"import dbConnect from \"../../../utils/dbConnect\";\nimport Posts from \"../../../models/post\";\nimport Sessions from \"../../../models/session\";\ndbConnect();\nexport default (async (req, res) => {\n  const {\n    method,\n    body,\n    headers: {\n      authorization\n    }\n  } = req;\n\n  switch (method) {\n    case \"GET\":\n      try {\n        const posts = await Posts.find({});\n        res.status(200).json({\n          success: true,\n          data: posts\n        });\n      } catch (err) {\n        res.status(400).json({\n          success: false\n        });\n      }\n\n      break;\n\n    case \"POST\":\n      try {\n        const session = await Sessions.findOne({\n          sessionId: authorization\n        });\n        body.author = session.userId;\n        const newPost = await Posts.create(body);\n        res.status(200).json({\n          success: true,\n          data: newPost\n        });\n      } catch (err) {\n        res.status(400).json({\n          success: false\n        });\n      }\n\n      break;\n\n    default:\n      res.status(400).json({\n        success: false\n      });\n      break;\n  }\n});","map":{"version":3,"sources":["/Users/blakedouglass/Desktop/projects/Pair_Programming/FeatherPen/pages/api/posts/index.js"],"names":["dbConnect","Posts","Sessions","req","res","method","body","headers","authorization","posts","find","status","json","success","data","err","session","findOne","sessionId","author","userId","newPost","create"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,0BAAtB;AACA,OAAOC,KAAP,MAAkB,sBAAlB;AACA,OAAOC,QAAP,MAAqB,yBAArB;AAEAF,SAAS;AAET,gBAAe,OAAOG,GAAP,EAAYC,GAAZ,KAAoB;AACjC,QAAM;AACJC,IAAAA,MADI;AAEJC,IAAAA,IAFI;AAGJC,IAAAA,OAAO,EAAE;AAAEC,MAAAA;AAAF;AAHL,MAIFL,GAJJ;;AAMA,UAAQE,MAAR;AACE,SAAK,KAAL;AACE,UAAI;AACF,cAAMI,KAAK,GAAG,MAAMR,KAAK,CAACS,IAAN,CAAW,EAAX,CAApB;AACAN,QAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,UAAAA,OAAO,EAAE,IAAX;AAAiBC,UAAAA,IAAI,EAAEL;AAAvB,SAArB;AACD,OAHD,CAGE,OAAOM,GAAP,EAAY;AACZX,QAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,UAAAA,OAAO,EAAE;AADU,SAArB;AAGD;;AACD;;AAEF,SAAK,MAAL;AACE,UAAI;AACF,cAAMG,OAAO,GAAG,MAAMd,QAAQ,CAACe,OAAT,CAAiB;AACrCC,UAAAA,SAAS,EAAEV;AAD0B,SAAjB,CAAtB;AAIAF,QAAAA,IAAI,CAACa,MAAL,GAAcH,OAAO,CAACI,MAAtB;AAEA,cAAMC,OAAO,GAAG,MAAMpB,KAAK,CAACqB,MAAN,CAAahB,IAAb,CAAtB;AACAF,QAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,UAAAA,OAAO,EAAE,IAAX;AAAiBC,UAAAA,IAAI,EAAEO;AAAvB,SAArB;AACD,OATD,CASE,OAAON,GAAP,EAAY;AACZX,QAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,UAAAA,OAAO,EAAE;AADU,SAArB;AAGD;;AACD;;AACF;AACET,MAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,QAAAA,OAAO,EAAE;AADU,OAArB;AAGA;AAhCJ;AAkCD,CAzCD","sourcesContent":["import dbConnect from \"../../../utils/dbConnect\";\nimport Posts from \"../../../models/post\";\nimport Sessions from \"../../../models/session\";\n\ndbConnect();\n\nexport default async (req, res) => {\n  const {\n    method,\n    body,\n    headers: { authorization },\n  } = req;\n\n  switch (method) {\n    case \"GET\":\n      try {\n        const posts = await Posts.find({});\n        res.status(200).json({ success: true, data: posts });\n      } catch (err) {\n        res.status(400).json({\n          success: false,\n        });\n      }\n      break;\n\n    case \"POST\":\n      try {\n        const session = await Sessions.findOne({\n          sessionId: authorization,\n        });\n\n        body.author = session.userId;\n\n        const newPost = await Posts.create(body);\n        res.status(200).json({ success: true, data: newPost });\n      } catch (err) {\n        res.status(400).json({\n          success: false,\n        });\n      }\n      break;\n    default:\n      res.status(400).json({\n        success: false,\n      });\n      break;\n  }\n};\n"]},"metadata":{},"sourceType":"module"}